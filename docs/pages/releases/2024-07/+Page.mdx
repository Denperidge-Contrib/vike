import { Link, Contribution, Construction } from '@brillout/docpress'
import { UiFrameworkExtension } from '../../../components'

What we have been working on in July.

<Construction>
 This page is work-in-progress until <code>01.08.2024</code>.
</Construction>

<Contribution>
  We are [looking for sponsors](https://github.com/vikejs/vike/issues/1350).
</Contribution>

**Bug fixes:** `n` (TODO)

**Features**

<Link href="#vike-react-apollo" /><br/>
<Link href="#improved-url-handling" /><br/>
<Link href="#injectscriptsat" /><br/>
<Link href="#clientonly" /><br/>
<Link href="#new-bati-integrations" /><br/>

**Project**

<Link href="#more-robust-foundation" /><br/>

**See also**

[`vike` > `CHANGELOG.md`](https://github.com/vikejs/vike/blob/main/CHANGELOG.md)  
[`vike-react` > `CHANGELOG.md`](https://github.com/vikejs/vike-react/blob/main/packages/vike-react/CHANGELOG.md)  
[`vike-vue` > `CHANGELOG.md`](https://github.com/vikejs/vike-vue/blob/main/packages/vike-vue/CHANGELOG.md)  
[`vike-solid` > `CHANGELOG.md`](https://github.com/vikejs/vike-solid/blob/main/CHANGELOG.md)  
<Link href="/releases" />  


## vike-react-apollo

The <Link href="/vike-react">`vike-react` extension</Link> now has first-class support for GraphQL Apollo thanks to the new [`vike-react-apollo` extension](https://github.com/vikejs/vike-react/tree/main/packages/vike-react-apollo#readme).

Like other extensions, `vike-react-apollo` is lightweight (only `202` lines of code!). This means that, instead of using `vike-react-apollo`, you can easily integrate GraphQL Apollo (or any other GraphQL client) yourself.

> Both `vike-react` and ` vike-react-apollo` are lightweight thanks to the heavy lifting done by Vike and [`react-streaming`](https://github.com/brillout/react-streaming). This showcases <Link href="/why">Vike's philosophy of having a sturdy core with lightweight extensions</Link>.

<Contribution>
  Author: [`nitedani`](https://github.com/nitedani)
</Contribution>


## Improved URL handling

Vike exports a new <Link href="/modifyUrl">`modifyUrl()` utiltiy</Link>, which is convenient for internationalization as shown in the example at <Link href="/i18n" />.

Also `pageContext.urlParsed` got new properties:

```
http://localhost:3000/some-base-url/hello/s%C3%A9bastien
```
```js
{
  pathname: '/hello/s√©bastien',
  pathnameOriginal: '/some-base-url/hello/s%C3%A9bastien',
  search: {},
  searchAll: {},
  searchOriginal: null,
  hash: '',
  hashOriginal: null,
  origin: 'http://localhost:3000',
  // Without Base URL, doesn't decode escaped characters // [!code ++]
  href: 'http://localhost:3000/hello/s%C3%A9bastien', // [!code ++]
  protocol: 'http://', // [!code ++]
  hostname: 'localhost', // [!code ++]
  port: 3000 // [!code ++]
}
```

<Contribution>
  Author: [`brillout`](https://github.com/brillout)
</Contribution>


## `injectScriptsAt`

The <Link href="/injectScriptsAt">new `injectScriptsAt` setting</Link> allows you to control where Vike injects scripts.

> It was already possible with <Link href="/injectFilter">`injectFilter()`</Link> but `injectScriptsAt` allows you to inject scripts at the begining of the <Link href="/streaming">HTML stream</Link> and is simpler to use.

<Contribution>
  Author: [`phonzammi`](https://github.com/phonzammi)
</Contribution>


## `clientOnly()`

Not only Vue and Solid users, but now also React users can use the <Link href="/clientOnly">`clientOnly()` helper</Link> which has the same functionality as the `<ClientOnly>` wrapper (now depreacted) but with a much improved DX.

<Contribution>
  Author: [`nitedani`](https://github.com/nitedani)
</Contribution>


## New Bati integrations

New [Bati](https://batijs.dev) integrations:
 - [Cloudflare](https://pages.cloudflare.com)

<Contribution>
  Author: [`phonzammi`](https://github.com/phonzammi), [`magne4000`](https://github.com/magne4000)
</Contribution>


## More robust foundation

We are continuously working on internal improvements. These aren't visible to the user but they have a foundational impact on Vike and its ecosystem, and we invest a lot in such foundational improvements.

For example, we refactored the stream chunk orchestration logic of [`react-streaming`](https://github.com/brillout/react-streaming) (which powers `vike-react` and other projects). [The code is now crystal clear and robust](https://github.com/brillout/react-streaming/commit/c052e72f33254fd6deb474cd784fa4cee07b6e92#diff-52301d8ceb8d9165f156883711407609a842701365fc32f512083f81c7c02dc4). (It was somewhat messy & buggy before.)

<Contribution>
  Authors: [`nitedani`](https://github.com/nitedani), [`brillout`](https://github.com/brillout)
</Contribution>


## See also

- [`vike` > `CHANGELOG.md`](https://github.com/vikejs/vike/blob/main/CHANGELOG.md)
- [`vike-react` > `CHANGELOG.md`](https://github.com/vikejs/vike-react/blob/main/packages/vike-react/CHANGELOG.md)
- [`vike-vue` > `CHANGELOG.md`](https://github.com/vikejs/vike-vue/blob/main/packages/vike-vue/CHANGELOG.md)
- [`vike-solid` > `CHANGELOG.md`](https://github.com/vikejs/vike-solid/blob/main/CHANGELOG.md)
- <Link href="/releases" />
